<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>스마트팜 대시보드</title>
  <link href="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
  <link href="details.css" rel="stylesheet" />
</head>
<body>
  <header>
    <div class="header-container">
      <div class="header-left">
        <h1 class="header-title">스마트팜 대시보드</h1>
        <!-- 이미지 대신 아이콘 사용 -->
        <button class="mode-toggle" id="mode-toggle" onclick="toggleMode()">
          <i class="fas fa-sun"></i>
        </button>
      </div>
      <div class="header-right">
        <a href="#" id="farmname">New 스마트팜</a>
        <span id="username">홍길동님</span>
        <button class="logout-btn" id="logout-btn">로그아웃</button>
        <button class="settings-icon" id="settingsBtn">
          <i class="fas fa-cog"></i>
        </button>
      </div>
    </div>
  </header>

  <!-- 설정 패널 -->
  <div class="settings-panel" id="settingsPanel">
    <div class="settings-content">
      <h2>설정</h2>
      <div class="setting-item">
        <div class="setting-label">
          <i class="fas fa-temperature-high setting-icon" style="color: var(--temp-color);"></i>
          <label>온도 최적 수치</label>
        </div>
        <div class="setting-inputs">
          <input id="temp-min" max="40" min="0" step="1" type="number" value="20" /> ~
          <input id="temp-max" max="40" min="0" step="1" type="number" value="30" /> °C
        </div>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <i class="fas fa-tint setting-icon" style="color: var(--humidity-color);"></i>
          <label>습도 최적 수치</label>
        </div>
        <div class="setting-inputs">
          <input id="humid-min" max="100" min="0" step="1" type="number" value="50" /> ~
          <input id="humid-max" max="100" min="0" step="1" type="number" value="70" /> %
        </div>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <i class="fas fa-leaf setting-icon" style="color: var(--soil-color);"></i>
          <label>토양 수분 최적 수치</label>
        </div>
        <div class="setting-inputs">
          <input id="soil-min" max="100" min="0" step="1" type="number" value="40" /> ~
          <input id="soil-max" max="100" min="0" step="1" type="number" value="60" /> %
        </div>
      </div>
      <div class="setting-item">
        <div class="setting-label">
          <i class="fas fa-wind setting-icon" style="color: var(--co2-color);"></i>
          <label>CO2 최적 수치</label>
        </div>
        <div class="setting-inputs">
          <input id="co2-min" max="2000" min="0" step="10" type="number" value="350" /> ~
          <input id="co2-max" max="2000" min="0" step="10" type="number" value="1000" /> ppm
        </div>
      </div>
      <div class="settings-buttons">
        <button id="closeSettings">취소</button>
        <button id="saveSettings">저장</button>
      </div>
    </div>
  </div>

  <main>
    <!-- 성장도 및 알림 배너 -->
    <div class="banner-container">
      <div class="growth-banner">
        <div class="growth-info">
          <h2>식물 성장도</h2>
          <div class="growth-status">
            <div class="growth-circle">
              <div class="growth-circle-inner">
                <span class="growth-rate" id="growth-rate">45%</span>
              </div>
            </div>
            <div class="growth-details">
              <p class="growth-text" id="growthText">현재 성장 단계: 성장</p>
              <div class="stage-indicator">
                <div class="stage active" data-stage="씨앗"><span class="stage-label">씨앗</span></div>
                <div class="stage active" data-stage="새싹"><span class="stage-label">새싹</span></div>
                <div class="stage active" data-stage="성장"><span class="stage-label">성장</span></div>
                <div class="stage" data-stage="열매"><span class="stage-label">열매</span></div>
              </div>
              <div class="growth-info-details">
                <div class="info-row">
                  <i class="fas fa-calendar-alt info-icon"></i>
                  <span id="start-date">시작일: 2023-05-01</span>
                </div>
                <div class="info-row">
                  <i class="fas fa-hourglass-half info-icon"></i>
                  <span id="d-day">D-Day: 15일 남음</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="notification-banner">
        <h2>알림</h2>
        <div class="alarm">
          <div class="alarm-content">
            <p class="text-bg" id="danger">🔴 위험</p>
            <p class="text-md" id="danger-head">온도가 너무 높습니다</p>
            <p class="text-md" id="danger-time">2023년 5월 12일 13:45분</p>
          </div>
          <div class="alarm-content">
            <p class="text-bg" id="warning">🟡 경고</p>
            <p class="text-md" id="warning-head">토양 수분이 낮아지고 있습니다</p>
            <p class="text-md" id="warning-time">2023년 5월 12일 12:30분</p>
          </div>
          <div class="alarm-content">
            <p class="text-bg" id="complete">🟢 완료</p>
            <p class="text-md" id="complete-head">급수 완료</p>
            <p class="text-md" id="complete-time">2023년 5월 12일 11:15분</p>
          </div>
        </div>
      </div>
    </div>

    <div class="tabs">
      <div class="tab active" data-tab="current">현재 상태</div>
      <div class="tab" data-tab="history">기록 데이터</div>
      <div class="tab" data-tab="cctv">CCTV 화면</div>
      <div class="tab" data-tab="alarm">알림 리스트</div>
      <div class="tab" data-tab="writeDiary">일지 리스트</div>
    </div>

    <!-- 현재 상태 탭 -->
    <div class="tab-content active" id="current-tab">
      <!-- 센서 패널 -->
      <div class="sensor-grid">
        <div class="card">
          <div class="card-header">
            <div class="card-title"><i class="fas fa-temperature-high" style="color: var(--temp-color);"></i> 온도</div>
          </div>
          <div class="card-content">
            <div class="flex-col gap-2">
              <div class="sensor-value temp">28<span class="sensor-unit">°C</span></div>
              <p class="text-sm text-muted">최적 수치: <span class="font-medium" id="temp-optimal">20 ~ 30</span></p>
              <div class="mt-2">
                <div class="progress-container">
                  <div class="progress-bar temp" style="width: 63%;"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-title"><i class="fas fa-tint" style="color: var(--humidity-color);"></i> 습도</div>
          </div>
          <div class="card-content">
            <div class="flex-col gap-2">
              <div class="sensor-value humidity">62<span class="sensor-unit">%</span></div>
              <p class="text-sm text-muted">최적 수치: <span class="font-medium" id="humid-optimal">50 ~ 70</span></p>
              <div class="mt-2">
                <div class="progress-container">
                  <div class="progress-bar humidity" style="width: 62%;"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-title"><i class="fas fa-leaf" style="color: var(--soil-color);"></i> 토양 수분</div>
          </div>
          <div class="card-content">
            <div class="flex-col gap-2">
              <div class="sensor-value soil">55<span class="sensor-unit">%</span></div>
              <p class="text-sm text-muted">최적 수치: <span class="font-medium" id="soil-optimal">40 ~ 60</span></p>
              <div class="mt-2">
                <div class="progress-container">
                  <div class="progress-bar soil" style="width: 55%;"></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-title"><i class="fas fa-wind" style="color: var(--co2-color);"></i> CO2</div>
          </div>
          <div class="card-content">
            <div class="flex-col gap-2">
              <div class="sensor-value co2">420<span class="sensor-unit">ppm</span></div>
              <p class="text-sm text-muted">최적 수치: <span class="font-medium" id="co2-optimal">350 ~ 1000</span></p>
              <div class="mt-2">
                <div class="progress-container">
                  <div class="progress-bar co2" style="width: 42%;"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 장치 제어 패널 -->
      <div class="card">
        <div class="card-header">
          <div class="card-title">장치 제어</div>
          <div class="card-description">스마트팜 장치를 원격으로 제어합니다</div>
        </div>
        <div class="card-content">
          <div class="device-grid">
            <div class="device-item">
              <div class="device-icon led" id="led-icon"><i class="fas fa-lightbulb"></i></div>
              <div class="device-name">LED</div>
              <div class="switch-container">
                <label class="switch"><input id="led-switch" onchange="updateDevice('led')" type="checkbox" /><span
                    class="slider"></span></label>
                <span class="switch-label" id="led-status">꺼짐</span>
              </div>
            </div>
            <div class="device-item">
              <div class="device-icon fan" id="fan-icon"><i class="fas fa-fan"></i></div>
              <div class="device-name">환풍팬</div>
              <div class="switch-container">
                <label class="switch"><input id="fan-switch" onchange="updateDevice('fan')" type="checkbox" /><span
                    class="slider"></span></label>
                <span class="switch-label" id="fan-status">꺼짐</span>
              </div>
            </div>
            <div class="device-item">
              <div class="device-icon water" id="water-icon"><i class="fas fa-tint"></i></div>
              <div class="device-name">급수</div>
              <div class="switch-container">
                <label class="switch"><input id="water-switch" onchange="updateDevice('water')"
                    type="checkbox" /><span class="slider"></span></label>
                <span class="switch-label" id="water-status">꺼짐</span>
              </div>
            </div>
            <div class="device-item">
              <div class="device-icon heater" id="heater-icon"><i class="fas fa-fire"></i></div>
              <div class="device-name">히터</div>
              <div class="switch-container">
                <label class="switch"><input id="heater-switch" onchange="updateDevice('heater')"
                    type="checkbox" /><span class="slider"></span></label>
                <span class="switch-label" id="heater-status">꺼짐</span>
              </div>
            </div>
            <div class="device-item">
              <div class="device-icon cooler" id="cooler-icon"><i class="fas fa-snowflake"></i></div>
              <div class="device-name">쿨러</div>
              <div class="switch-container">
                <label class="switch"><input id="cooler-switch" onchange="updateDevice('cooler')"
                    type="checkbox" /><span class="slider"></span></label>
                <span class="switch-label" id="cooler-status">꺼짐</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 챗봇 패널 -->
      <div class="card chatbot-card">
        <div class="card-header">
          <div class="card-title"><i class="fas fa-comment-dots" style="color: var(--primary-color);"></i> 스마트팜 챗봇</div>
          <div class="card-description">스마트팜 관련 질문에 답변해 드립니다</div>
        </div>
        <div class="card-content">
          <div class="chat-container">
            <div class="chat-messages">
              <div class="message bot">
                <div class="message-content">안녕하세요! 스마트팜 챗봇입니다. 무엇을 도와드릴까요?</div>
              </div>
              <div class="message user">
                <div class="message-content">토마토 재배에 적합한 온도는 어떻게 되나요?</div>
              </div>
              <div class="message bot">
                <div class="message-content">
                  토마토 재배에 적합한 온도는 주간 21-27°C, 야간 16-18°C입니다. 현재 설정된 온도 범위는 20-30°C로,
                  적정 범위 내에 있습니다.
                </div>
              </div>
            </div>
            <div class="chat-input">
              <input type="text" placeholder="메시지를 입력하세요..." id="chat-input-field" />
              <button class="send-button" id="send-button">전송</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 기록 데이터 탭 -->
    <div class="tab-content" id="history-tab">
      <div class="card" style="margin-top: 1rem;">
        <div class="card-header">
          <div class="card-title">실시간 센서 데이터</div>
          <div class="card-description">최근 24시간 데이터 추이</div>
        </div>
        <div class="card-content">
          <div class="chart-container"><canvas id="realtime-chart"></canvas></div>
        </div>
      </div>
      <div class="card">
        <div class="card-header">
          <div class="card-title">센서 데이터 기록</div>
          <div class="card-description">
            <span id="history-date"></span>
            <input type="date" id="date-picker" style="margin-left: 10px; padding: 5px; border-radius: 4px; border: 1px solid var(--border-color);">
          </div>        
        </div>
        <div class="card-content">
          <div class="sensor-tabs">
            <div class="sensor-tab active temp" data-sensor="temperature">온도</div>
            <div class="sensor-tab humidity" data-sensor="humidity">습도</div>
            <div class="sensor-tab soil" data-sensor="soil">토양 수분</div>
            <div class="sensor-tab co2" data-sensor="co2">CO2</div>
          </div>
          <div class="sensor-chart active" id="temperature-chart"><canvas id="temperature-canvas"></canvas></div>
          <div class="sensor-chart" id="humidity-chart"><canvas id="humidity-canvas"></canvas></div>
          <div class="sensor-chart" id="soil-chart"><canvas id="soil-canvas"></canvas></div>
          <div class="sensor-chart" id="co2-chart"><canvas id="co2-canvas"></canvas></div>
        </div>
        <div class="card-footer">
          <button class="btn" id="prev-date"><i class="fas fa-chevron-left"></i> 이전 날짜</button>
          <button class="btn" id="next-date">다음 날짜 <i class="fas fa-chevron-right"></i></button>
        </div>
      </div>
    </div>

    <!-- CCTV 화면 탭 -->
    <div class="tab-content" id="cctv-tab">
      <div class="card">
        <div class="card-header">
          <div class="card-title">스마트팜 CCTV 화면</div>
        </div>
        <div class="card-content">
          <div class="iframe-wrapper">
            <iframe src="https://rd-advances-meters-reports.trycloudflare.com/monitor"></iframe>
          </div>
        </div>
      </div>
    </div>

    <!-- 알림 리스트 탭 -->
    <div class="tab-content" id="alarm-tab">
      <div class="card">
        <div class="card-header">
          <div class="card-title">알림 리스트</div>
        </div>
        <div class="card-content">
          <div class="filter">
            <label for="alarm-filter">알림 유형 필터: </label>
            <select id="alarm-filter">
              <option value="">전체</option>
              <option value="위험">위험</option>
              <option value="경고">경고</option>
              <option value="완료">완료</option>
            </select>
          </div>
          <table id="alarm-list-table">
            <thead>
              <tr>
                <th>알림 내용</th>
                <th>시간</th>
                <th>장치</th>
                <th>유형</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- 일지 리스트 탭 -->
    <div class="tab-content" id="writeDiary-tab">
      <div class="card">
        <div class="card-header">
          <div class="card-title"><i class="fas fa-file-alt"></i> 스마트팜 일일 리포트</div>
          <div class="card-description">스마트팜의 일일 데이터를 분석하여 AI가 자동으로 리포트를 생성합니다</div>
        </div>
        <div class="card-content">
          <div class="diary-actions">
            <button id="generateDiaryBtn" class="generate-report-btn">
              <i class="fas fa-plus-circle"></i> 리포트 생성
            </button>
            <div class="search-container">
              <i class="fas fa-search search-icon"></i>
              <input type="text" id="reportSearchInput" placeholder="날짜로 검색..." class="search-input">
            </div>
          </div>
          <div class="diary-list">
            <div class="diary-list-header">
              <h3><i class="fas fa-list"></i> 최근 생성된 리포트</h3>
              <span class="report-count" id="reportCount">0개</span>
            </div>
            <div class="diary-entries-container">
              <ul id="diaryEntries" class="diary-entries"></ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer>
    <div class="footer-container">
      <div class="footer-copyright">© 2023 스마트팜 대시보드. All rights reserved.</div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
  <script src="details.js"></script>
</body>
</html>